/* =========================================
   1. CSS Variables & Theming
   ========================================= */
:root {
    /* Key Colors */
    --color-primary: #00A3BF;
    /* cyan600 */
    --color-secondary: #2BC8E4;
    /* cyan400 */
    --color-tertiary: #008299;
    /* cyan800 */

    /* Functional Colors */
    --color-success: #10B981;
    --color-warning: #F59E0B;
    --color-danger: #EF4444;
    --color-info: #3B82F6;

    /* Background Colors (Light Mode) */
    --bg-main: #FFFFFF;
    --bg-secondary: #F0F9FA;
    --bg-card: #FFFFFF;
    --bg-input: #F9FAFB;

    /* Text Colors (Light Mode) */
    --text-primary: #1F2937;
    --text-secondary: #4B5563;
    --text-tertiary: #6B7280;
    --text-link: #008299;
    --text-btn: #FFFFFF;

    /* Spacing */
    --space-xs: 4px;
    --space-sm: 8px;
    --space-md: 16px;
    --space-lg: 24px;
    --space-xl: 32px;

    /* Typography */
    --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    --font-size-base: 16px;
    --font-size-sm: 14px;
    --font-size-lg: 18px;
    --font-size-xl: 24px;

    /* Borders & Radius */
    --border-radius-sm: 4px;
    --border-radius-md: 8px;
    --border-radius-lg: 12px;
    --border-color: #E5E7EB;

    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);

    /* Transitions */
    --transition-base: 0.2s ease-in-out;
}

/* Dark Mode Overrides */
@media (prefers-color-scheme: dark) {
    :root {
        /* Key Colors Adjusted */
        --color-primary: rgba(0, 163, 191, 0.9);
        /* Opacity 0.9 */
        /* Secondary stays #2BC8E4 */
        --color-tertiary: #00A3BF;
        /* Lighter for dark mode */

        /* Background Colors */
        --bg-main: #0B1F24;
        --bg-secondary: #142B32;
        --bg-card: #1A3942;
        --bg-input: #0F262E;

        /* Text Colors */
        --text-primary: #F9FAFB;
        --text-secondary: #D1D5DB;
        --text-tertiary: #9CA3AF;
        --text-link: #2BC8E4;
        --text-btn: #0B1F24;
        /* Dark text on bright buttons */

        --border-color: #374151;
    }
}

/* =========================================
   2. Global Reset & Base Styles
   ========================================= */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: var(--font-family);
    font-size: var(--font-size-base);
    line-height: 1.6;
    background-color: var(--bg-secondary);
    color: var(--text-primary);
    -webkit-font-smoothing: antialiased;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    color: var(--text-primary);
    /* Or Tertiary for specific headers if needed */
    font-weight: 700;
    margin-bottom: var(--space-md);
}

h1 {
    font-size: var(--font-size-xl);
}

h2 {
    font-size: 20px;
    color: var(--color-tertiary);
}

a {
    color: var(--text-link);
    text-decoration: none;
    transition: color var(--transition-base);
}

a:hover {
    color: var(--color-secondary);
}

button {
    cursor: pointer;
    font-family: inherit;
    border: none;
    outline: none;
}

/* Utility Classes */
.hidden {
    display: none !important;
}

.text-center {
    text-align: center;
}

.text-warning {
    color: var(--color-warning) !important;
    font-weight: 600;
}

.mt-md {
    margin-top: var(--space-md);
}

/* =========================================
   3. Layout & Container
   ========================================= */
.container {
    width: 100%;
    max-width: 1280px;
    margin: 0 auto;
    padding: var(--space-lg);
}

/* View Sections */
.view-section {
    min-height: calc(100vh - 80px);
    /* Adjust based on header height */
    padding-bottom: var(--space-xl);
    animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* =========================================
   4. Header & Navigation
   ========================================= */
#app-header {
    background-color: var(--bg-card);
    box-shadow: var(--shadow-sm);
    position: sticky;
    top: 0;
    z-index: 100;
}

.header-container {
    max-width: 1280px;
    margin: 0 auto;
    padding: var(--space-md) var(--space-lg);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
}

.app-title {
    font-size: 20px;
    color: var(--color-tertiary);
    margin-bottom: 0;
}

.main-nav {
    display: flex;
    gap: var(--space-sm);
}

.nav-btn {
    background-color: transparent;
    color: var(--text-secondary);
    padding: var(--space-sm) var(--space-md);
    border-radius: var(--border-radius-md);
    font-weight: 500;
    transition: all var(--transition-base);
    font-size: var(--font-size-sm);
}

.nav-btn:hover {
    background-color: var(--bg-secondary);
    color: var(--color-secondary);
}

.nav-btn.active {
    background-color: var(--color-primary);
    color: var(--text-btn);
}

/* Mobile Navigation */
@media (max-width: 767px) {
    .header-container {
        flex-direction: column;
        gap: var(--space-md);
        padding: var(--space-md);
    }

    .main-nav {
        width: 100%;
        justify-content: space-between;
        /* Distribute evenly */
        gap: var(--space-xs);
    }

    .nav-btn {
        padding: var(--space-sm);
        font-size: 12px;
        /* Smaller font for mobile */
        flex: 1;
        text-align: center;
    }
}

/* =========================================
   5. Components (Forms, Buttons, Cards)
   ========================================= */

/* Cards (Implicit in sections, but can be explicit) */
.info-card {
    background-color: var(--bg-card);
    padding: var(--space-md);
    border-radius: var(--border-radius-md);
    box-shadow: var(--shadow-sm);
    margin-bottom: var(--space-lg);
    border-left: 4px solid var(--color-primary);
}

/* Forms */
.form-group {
    margin-bottom: var(--space-lg);
    position: relative;
    /* For tooltips */
}

label {
    display: block;
    margin-bottom: var(--space-sm);
    font-weight: 500;
    color: var(--text-secondary);
}

.required::after {
    content: " *";
    color: var(--color-danger);
    vertical-align: middle;
}

input[type="text"],
input[type="number"],
input[type="time"],
textarea,
select {
    display: block;
    box-sizing: border-box;
    width: 100%;
    max-width: 100%;
    padding: 12px var(--space-md);
    background-color: var(--bg-input);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-md);
    color: var(--text-primary);
    font-size: var(--font-size-base);
    transition: border-color var(--transition-base), box-shadow var(--transition-base);
}

/* Align the width and left-align the text */
input[type="time"] {
    -webkit-appearance: none;
    appearance: none;
    min-width: 0;
}

input[type="time"]::-webkit-date-and-time-value {
    text-align: left;
}

input:focus,
textarea:focus,
select:focus {
    border-color: var(--color-secondary);
    box-shadow: 0 0 0 3px rgba(43, 200, 228, 0.2);
}

input:disabled,
textarea:disabled,
select:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    background-color: rgba(0, 0, 0, 0.05);
    /* Slightly darker for disabled */
}

/* Character Count */
.char-count {
    text-align: right;
    font-size: var(--font-size-sm);
    color: var(--text-tertiary);
    margin-top: var(--space-xs);
}

/* Buttons */
.btn-primary,
.btn-secondary,
.btn-danger {
    padding: 12px 24px;
    border-radius: var(--border-radius-md);
    font-weight: 600;
    font-size: var(--font-size-base);
    transition: all var(--transition-base);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 120px;
}

.btn-primary {
    background-color: var(--color-primary);
    color: var(--text-btn);
}

.btn-primary:hover:not(:disabled) {
    background-color: var(--color-secondary);
    transform: translateY(-1px);
}

.btn-secondary {
    background-color: transparent;
    border: 1px solid var(--color-secondary);
    color: var(--color-secondary);
}

.btn-secondary:hover:not(:disabled) {
    background-color: rgba(43, 200, 228, 0.1);
}

.btn-danger {
    background-color: transparent;
    border: 1px solid var(--color-danger);
    color: var(--color-danger);
}

.btn-danger:hover:not(:disabled) {
    background-color: rgba(239, 68, 68, 0.1);
}

button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none !important;
}

.form-actions {
    display: flex;
    gap: var(--space-md);
    margin-top: var(--space-xl);
}

/* Mobile Buttons */
@media (max-width: 767px) {
    .form-actions {
        flex-direction: column;
    }

    .btn-primary,
    .btn-secondary,
    .btn-danger {
        width: 100%;
        min-height: 44px;
        /* Touch target size */
    }
}

/* Checkbox */
.checkbox-group {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.checkbox-group label {
    margin-bottom: 0;
    cursor: pointer;
}

input[type="checkbox"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
    accent-color: var(--color-primary);
}

/* Sliders */
.slider-group {
    display: flex;
    flex-direction: column;
}

input[type="range"] {
    width: 100%;
    margin: var(--space-sm) 0;
    cursor: pointer;
    accent-color: var(--color-primary);
}

.slider-value {
    text-align: center;
    font-weight: bold;
    color: var(--color-primary);
}

/* =========================================
   6. View Specific Styles
   ========================================= */

/* Loading View */
#view-loading {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.spinner {
    width: 50px;
    height: 50px;
    border: 4px solid var(--bg-input);
    border-top: 4px solid var(--color-primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: var(--space-md);
}

.spinner-container {
    text-align: center;
    color: var(--text-secondary);
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(360deg);
    }
}

/* Login View */
#view-login {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-main) 100%);
}

.login-container {
    width: 100%;
    max-width: 400px;
    padding: var(--space-lg);
}

.login-card {
    background-color: var(--bg-card);
    padding: var(--space-xl);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-lg);
    text-align: center;
}

.login-title {
    font-size: 28px;
    color: var(--color-tertiary);
    margin-bottom: var(--space-sm);
}

.login-description {
    color: var(--text-secondary);
    margin-bottom: var(--space-xl);
    font-size: var(--font-size-sm);
}

.btn-google-login {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-sm);
    width: 100%;
    padding: 14px 24px;
    background-color: #4285F4;
    color: #FFFFFF;
    font-size: var(--font-size-base);
    font-weight: 600;
    border: none;
    border-radius: var(--border-radius-md);
    cursor: pointer;
    transition: all var(--transition-base);
}

.btn-google-login:hover {
    background-color: #357ABD;
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.btn-google-login:active {
    transform: translateY(0);
}

.btn-google-login i {
    font-size: 18px;
}

/* Logout Button in Header */
.nav-btn-logout {
    background-color: transparent;
    color: var(--text-tertiary);
    padding: var(--space-sm);
    min-width: auto;
}

.nav-btn-logout:hover {
    color: var(--color-danger);
    background-color: rgba(239, 68, 68, 0.1);
}

/* Record View */
.disabled-section {
    opacity: 0.5;
    pointer-events: none;
    transition: opacity var(--transition-base);
}

.disabled-section.active {
    opacity: 1;
    pointer-events: auto;
}

/* Results View */
.results-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-md);
}

.icon-btn {
    background: none;
    color: var(--text-secondary);
    font-size: 24px;
    padding: var(--space-sm);
}

.icon-btn:hover {
    color: var(--color-primary);
}

.calendar-container {
    background-color: var(--bg-card);
    padding: var(--space-md);
    border-radius: var(--border-radius-md);
    margin-bottom: var(--space-lg);
    box-shadow: var(--shadow-sm);
}

/* Accordion for Charts & Library */
.accordion-item {
    margin-bottom: var(--space-md);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-md);
    background-color: var(--bg-card);
    overflow: hidden;
}

.accordion-header {
    width: 100%;
    text-align: left;
    padding: var(--space-md);
    background-color: var(--bg-card);
    color: var(--text-primary);
    font-weight: 600;
    /* display: flex; REMOVED to allow list-style behavior for summary */
    cursor: pointer;
    list-style: none;
    /* Hide default triangle */
    position: relative;
    padding-right: 40px;
    /* Space for Custom Marker */
}

.accordion-header:hover {
    background-color: var(--bg-secondary);
}

.accordion-header::-webkit-details-marker {
    display: none;
}

.accordion-header::after {
    content: '+';
    position: absolute;
    right: var(--space-md);
    top: 50%;
    transform: translateY(-50%);
    font-weight: bold;
    color: var(--text-secondary);
    /* Use secondary or match header color? standard is usually muted */
}

.accordion-item[open] .accordion-header::after {
    content: '-';
}

.accordion-content {
    padding: var(--space-md);
    border-top: 1px solid var(--border-color);
    background-color: var(--bg-main);
}

/* Library View */
.library-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
}

.library-item {
    background-color: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-md);
}

.library-item summary {
    padding: var(--space-md);
    cursor: pointer;
    font-weight: 600;
    color: var(--color-tertiary);
    list-style: none;
    /* Hide default triangle */
    position: relative;
}

.library-item summary::-webkit-details-marker {
    display: none;
}

.library-item summary::after {
    content: '+';
    position: absolute;
    right: var(--space-md);
    font-weight: bold;
}

.library-item[open] summary::after {
    content: '-';
}

.library-content {
    padding: var(--space-md);
    padding-top: 0;
    color: var(--text-secondary);
    line-height: 1.8;
}

/* =========================================
   7. Modals & Tooltips
   ========================================= */

/* Modal */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 1;
    transition: opacity 0.3s ease;
}

.modal-overlay.hidden {
    opacity: 0;
    pointer-events: none;
}

.modal-content {
    background-color: var(--bg-card);
    padding: var(--space-xl);
    border-radius: var(--border-radius-lg);
    width: 90%;
    max-width: 500px;
    box-shadow: var(--shadow-lg);
    transform: translateY(0);
    transition: transform 0.3s ease;
    text-align: center;
}

.modal-overlay.hidden .modal-content {
    transform: translateY(20px);
}

#modal-message {
    margin-bottom: var(--space-lg);
    font-size: var(--font-size-lg);
    color: var(--text-primary);
}

/* Tooltips */
.tooltip {
    display: none;
    position: absolute;
    background-color: var(--text-primary);
    color: var(--bg-main);
    padding: var(--space-xs) var(--space-sm);
    border-radius: var(--border-radius-sm);
    font-size: var(--font-size-sm);
    bottom: 100%;
    left: 0;
    white-space: nowrap;
    z-index: 10;
    box-shadow: var(--shadow-md);
}

/* Desktop: Show tooltip on hover/focus */
@media (min-width: 960px) {

    .form-group:hover .tooltip,
    input:focus+.tooltip {
        display: block;
    }
}

/* Mobile/Tablet: Use info icon approach if strictly needed, 
   but for simplicity and standard HTML behavior, 
   we rely on the placeholder or helper text for now, 
   or the tooltip class can be toggled via JS if we add an icon. 
   Requirements mentioned "Info icon" for mobile. 
   I will add a pseudo-element or class for that if I were modifying HTML, 
   but here I'll stick to CSS. 
   Let's make sure tooltips are visible when active on mobile if possible, 
   or rely on the text below input. */

/* =========================================
   8. Chart.js Customization (Canvas)
   ========================================= */
canvas {
    max-width: 100%;
}

/* Chart container sizing for proper Chart.js rendering */
.accordion-content {
    height: 700px;
}

@media (max-width: 767px) {
    .accordion-content {
        height: 400px;
    }
}

/* =========================================
   9. Validation Feedback
   ========================================= */
.input-error {
    border-color: var(--color-danger) !important;
    box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.2) !important;
}

.tooltip-error {
    position: absolute;
    background-color: var(--color-danger);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    bottom: 100%;
    left: 0;
    white-space: nowrap;
    z-index: 10;
    margin-bottom: 4px;
    animation: fadeIn 0.2s ease-out;
}

.tooltip-error::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 10px;
    border-width: 5px;
    border-style: solid;
    border-color: var(--color-danger) transparent transparent transparent;
}

/* =========================================
   10. Calendar Styles
   ========================================= */
.day-success {
    background-color: rgba(16, 185, 129, 0.2) !important;
    border-color: var(--color-success) !important;
}

.day-failure {
    background-color: rgba(239, 68, 68, 0.1) !important;
}

/* Flatpickr Customization */
.flatpickr-calendar {
    margin: 0 auto;
    box-shadow: none !important;
    border: 1px solid var(--border-color) !important;
}